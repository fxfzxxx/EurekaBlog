<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <!--<![endif]-->
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="./css/reset.css">
        <link rel="stylesheet" href="./fas/css/all.css">
        <link rel="stylesheet" href="./css/index.css">
        <link rel="stylesheet" href="./css/base.css">
        <link rel="icon" href="//s01.mifile.cn/favicon.ico" type="image/x-icon" />
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <!-- 顶部导航 -->
        <!-- 外部容器 -->
        <div class="topbar-wrapper">
            <div class="topbar w clearfix">
                <!-- 左侧导航 -->
                <ul class="service">
                    <li><a href="javascript:;">小米商城</a></li>
                    <li class="line">|</li>
                    <li><a href="javascript:;">MIUI</a></li>
                    <li class="line">|</li>
                    <li><a href="javascript:;">IoT</a></li>
                    <li class="line">|</li>
                    <li><a href="javascript:;">云服务</a></li>
                    <li class="line">|</li>
                    <li><a href="javascript:;">金融</a></li>
                    <li class="line">|</li>
                    <li><a href="javascript:;">有品</a></li>
                    <li class="line">|</li>
                    <li><a href="javascript:;">小爱开放平台</a></li>
                    <li class="line">|</li>
                    <li><a href="javascript:;">企业团购</a></li>
                    <li class="line">|</li>
                    <li><a href="javascript:;">资质证明</a></li>
                    <li class="line">|</li>
                    <li><a href="javascript:;">协议规则</a></li>
                    <li class="line">|</li>
                    <li>
                        <a class="app" href="javascript:;">下载app
                            <div class="qrcode">
                                <img src="./img/download.png" alt="">
                                <span>小米商城app</span>
                            
                            </div>
                         </a>
                    </li>
                    
                    <li class="line">|</li>
                    <li><a href="javascript:;">Select Location</a></li>
                </ul>       
                <!-- 购物车         -->
                <ul class="shop-cart">
                    <li><a href="javacript:;">
                            <i class="fas fa-shopping-cart"></i>
                            购物车 (0)
                            
                        </a>
                        <div class="items">
                            <span>购物车中什么也没有,开始选购吧!</span>
                        </div>
                    </li>
                </ul>
                <!-- 用户信息 -->
                <ul class="user-info">
                    <li><a href="javascript:;">登录</a></li>
                    <li class="line">|</li>
                    <li><a href="javascript:;">注册</a></li>
                    <li class="line">|</li>
                    <li><a href="javascript:;">消息通知</a></li>
                </ul>
            </div>
        </div>
        <!-- 头部容器 -->
        <div class="head-wrapper">
            <!-- 头部导航 -->
            <div class="head w clearfix">
                <!-- 头部logo容器 -->
                <div class="logo" title='Xiaomi'>                   
                    <div class="home">
                        <a href="/"></a>
                    </div>
                    <div class="mi">
                        <a href="/"></a>
                    </div>
                    小米官网
                </div>
                <!-- 头部导航条容器 -->
                <div class="navbar-wrapper">
                    <ul class="navbar">
                        <li class="left-menu-wrapper">
                            <a class="more-products all-products" href="#">全部商品分类</a>
                            <ul class='left-menu'>
                                <li>
                                    <a href="#">
                                        手机 电话卡 <em class="fas fa-angle-right"></em>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                       电视 盒子 <em class="fas fa-angle-right"></em>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        笔记本 平板 <em class="fas fa-angle-right"></em>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        家电 插线板 <em class="fas fa-angle-right"></em>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        出行 穿戴 <em class="fas fa-angle-right"></em>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        智能 路由器 <em class="fas fa-angle-right"></em>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        电源 配件 <em class="fas fa-angle-right"></em>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        健康 儿童 <em class="fas fa-angle-right"></em>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        耳机 音响 <em class="fas fa-angle-right"></em>
                                    </a>
                                </li>  
                                <li>
                                    <a href="#">
                                        生活 箱包 <em class="fas fa-angle-right"></em>
                                    </a>
                                </li> 
                            </ul>
                        </li>
                        <!-- <li class="more-products"><a href="#">小米手机</a></li>
                        <li class="more-products"><a href="#">Redmi 红米</a></li>
                        <li class="more-products"><a href="#">电视</a></li>
                        <li class="more-products"><a href="#">笔记本</a></li>
                        <li class="more-products"><a href="#">家电</a></li>
                        <li class="more-products"><a href="#">路由器</a></li>
                        <li class="more-products"><a href="#">智能硬件</a></li> -->
                        <li class="service"><a href="#">服务</a></li>
                        <li><a href="#">社区</a></li>

                        <div class="products-info">                          
                        </div>
                    </ul>
                </div>
                <!-- 头部搜索框容器 -->
                <div class="search-box-wrapper">
                    <form class="search-box" action="#">
                        <input class="search-input" type="text"search" name="index-search" placeholder="家电"/>
                        <button class="search-button">
                            <em class="fas fa-search"></em>
                        </button>
                    </form>
                    
                </div>

            </div>
        </div>
        <!-- banner容器 -->
        <div class="banner-wrapper clearfix">
            <div class="banner w">
                <!-- 轮播图 -->
                <ul class="image-list">
                    <li><img src="./img/banner1.jpg" alt=""></li>
                    <li><img src="./img/banner2.jpg" alt=""></li>
                    <li><img src="./img/banner3.jpg" alt=""></li>
                    <li><img src="./img/banner4.jpg" alt=""></li>
                    <li><img src="./img/banner5.jpg" alt=""></li>
                </ul>
                <!-- 轮播图右下角选择 -->
                <div class="pointer">
                    <!-- <a class="active" href="javascript:;"></a>
                    <a href="javascript:;"></a>
                    <a href="javascript:;"></a>
                    <a href="javascript:;"></a>
                    <a href="javascript:;"></a> -->
                </div>
                <div class="mover">
                    <div><a class="left" href="javascript:;"></a></div>
                    <div><a class="right" href="javascript:;"></a></div>
                </div>
            </div>
        </div>
        <!-- 右侧固定工具栏 -->
        <div class="right-menu"></div>
        <script src="./js/data.js" ></script>
        <script src="./js/sub-menu.js"></script>
        <script src="./js/utils.js"></script>
        <script>
            const imgList = document.querySelector('ul.image-list')
            const pointerBox = document.querySelector('div.pointer')
            const banner = document.querySelector('.banner')
            const left = document.querySelector('.left')
            const right = document.querySelector('.right')
            const banner_width = banner.clientWidth
            let timer = 0
            let index = 1
            let flag = true
            // 生成右下选择点
            setPointer()
            function setPointer() {
                let num = imgList.children.length
                const frg = document.createDocumentFragment()
                for (i = 0; i < num; i++) {
                    const a = document.createElement('a')
                    a.setAttribute('type','point')
                    a.setAttribute('index',i+1)
                    if(i===0) a.classList.add('active')
                    frg.appendChild(a)
                }
                pointerBox.appendChild(frg)
            }       
            // 复制元素
            copyEle()
            function copyEle() {
                const first = imgList.firstElementChild.cloneNode(true)
                const last = imgList.lastElementChild.cloneNode(true)
                imgList.insertBefore(last, imgList.firstElementChild)
                imgList.appendChild(first)
                imgList.style.width = imgList.children.length * 100 + '%'
                imgList.style.left = -banner_width + 'px'

            }

            //自动轮播
            autoPlay()
            function autoPlay() {
                timer = setInterval(() => {
                    index++
                    move(imgList,{left: -index * banner_width},moveEnd)
                    
                }, 2500)
            }
            //运动结束
            function moveEnd() {
                if (index === imgList.children.length - 1) {
                    index = 1
                    imgList.style.left = -banner_width + 'px'
                }

                if (index === 0 ) {
                    index = imgList.children.length - 2
                    imgList.style.left = -index * banner_width + 'px'
                }

                for (let i = 0; i < pointerBox.children.length; i++) {
                    pointerBox.children[i].className = ''                   
                }
                pointerBox.children[index-1].className = 'active'
                flag = true
            }
            //移入移出停止轮播
            overOut()
            function overOut(){
                banner.addEventListener('mouseover',() => {
                    clearInterval(timer)
                    // console.log('over');
                })
                banner.addEventListener('mouseout',() => autoPlay())
            }
            //点击事件
            bindEvent()
            function bindEvent() {
                banner.addEventListener('click',e => {
                    e = e || window.event
                    const target = e.target || e.srcElement
                    // clearInterval(timer)
                    if (target ===right) {

                        if (!flag) return
                        flag = false // 无法连续点击
                        index++
                        move(imgList,{left: -index * banner_width},moveEnd)
                    }
                    if (target ===left) {
                        if (!flag) return
                        flag = false
                        index--
                        move(imgList,{left: -index * banner_width},moveEnd)
                    }
                    if (target.getAttribute('type') === 'point') {
                        if (!flag) return
                        flag = false
                        console.log('point');
                        index = target.getAttribute('index') - 0
                        move(imgList,{left: -index * banner_width},moveEnd)
                    }


                })
            }
            changeTag()
            function changeTag() {
                document.addEventListener('visibilitychange',() => {
                    console.log(document.visibilityState);
                    if (document.visibilityState === 'hidden') {
                        clearInterval(timer)
                    }
                    if (document.visibilityState === 'visible') {
                        autoPlay()
                    }
                })
                
            }
        </script>
    </body>
</html>